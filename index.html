<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1, viewport-fit=cover" />
  <title>ูุณู ููุงุกุฉ ุงูุทุงูุฉ | ูุฒุงุฑุฉ ุงูููุฑุจุงุก ูุงููุงุก ูุงูุทุงูุฉ ุงููุชุฌุฏุฏุฉ</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --primary: #0b5fa8;
      --primary-2:#0a4f8a;
      --bg: #f6f9fc;
      --card: #ffffff;
      --text: #12212f;
      --muted:#5a6b7b;
      --border:#e6edf5;
      --shadow: 0 10px 30px rgba(10, 40, 70, .08);
      --radius: 18px;
    }

    *{ box-sizing:border-box; }
    html, body{ height:100%; }

    body{
      margin:0;
      font-family: "Cairo", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 420px at 50% 0%, rgba(11,95,168,.10), transparent 55%),
                  var(--bg);
      color:var(--text);
      line-height:1.85;
      -webkit-text-size-adjust: 100%;
      overscroll-behavior: none;
    }

    .container{
      width:min(1100px, calc(100% - 32px));
      margin-inline:auto;
    }

    header{
      position:sticky;
      top:0;
      z-index:10;
      background:rgba(246,249,252,.90);
      backdrop-filter: blur(10px);
      border-bottom:1px solid var(--border);
    }

    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
      padding:14px 0;
    }

    .logo-wrap{
      display:flex;
      align-items:center;
      justify-content:flex-end;
      min-width: 320px;
    }
    .header-logo{
      width: clamp(220px, 30vw, 380px);
      height: auto;
      object-fit: contain;
      filter: drop-shadow(0 8px 18px rgba(10,40,70,.12));
      border-radius: 12px;
    }

    .title-wrap{
      flex:1;
      text-align:center;
      padding:6px 12px;
    }

    .title{
      margin:0;
      font-size: clamp(18px, 3.2vw, 30px);
      font-weight:900;
      color:var(--primary);
      letter-spacing:.2px;
    }

    main{ padding:28px 0 60px; }

    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      padding:20px 22px;
    }

    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap:16px;
      margin-top:18px;
    }

    .section-title{
      margin:0 0 6px;
      font-size:18px;
      font-weight:900;
      color:var(--primary-2);
    }
    .section-text{
      margin:0;
      color:var(--text);
      font-weight:700;
    }

    .actions{
      display:flex;
      gap:14px;
      flex-wrap:wrap;
      justify-content:center;
      margin-top:22px;
    }

    .btn{
      appearance:none;
      border:1px solid rgba(11,95,168,.25);
      background: linear-gradient(180deg, rgba(11,95,168,.10), rgba(11,95,168,.04));
      color:var(--primary-2);
      border-radius: 14px;
      padding:12px 16px;
      font-weight:900;
      cursor:pointer;
      min-width: 240px;
      transition: transform .12s ease, box-shadow .12s ease, background .12s ease;
      box-shadow: 0 10px 20px rgba(11,95,168,.08);
      touch-action: manipulation;
    }
    .btn:hover{ transform: translateY(-1px); }
    .btn:active{ transform: translateY(0px); box-shadow:none; }

    .btn.primary{
      background: linear-gradient(180deg, var(--primary), var(--primary-2));
      border-color: rgba(255,255,255,.25);
      color:#fff;
    }
    .btn.ghost{
      background:#fff;
      border:1px solid var(--border);
      color:var(--muted);
      box-shadow:none;
    }
    .btn.small{
      min-width:auto;
      padding:10px 14px;
      border-radius: 12px;
    }

    /* modal */
    .backdrop{
      position:fixed;
      inset:0;
      background:rgba(10, 25, 40, .55);
      display:none;
      align-items:center;
      justify-content:center;
      padding:18px;
      z-index:50;
      overscroll-behavior: contain;
    }
    .backdrop.open{ display:flex; }

    .modal{
      width:min(860px, 100%);
      background:var(--card);
      border-radius: 20px;
      border:1px solid var(--border);
      box-shadow: 0 22px 60px rgba(0,0,0,.25);
      overflow:hidden;
      transform: translateY(6px);
      animation: pop .14s ease-out forwards;
      max-height: calc(100dvh - 36px);
      display:flex;
      flex-direction:column;
    }
    @keyframes pop { to { transform: translateY(0); } }

    .modal-header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:14px 16px;
      border-bottom:1px solid var(--border);
      background: linear-gradient(180deg, rgba(11,95,168,.10), transparent);
      flex: 0 0 auto;
    }
    .modal-title{
      margin:0;
      font-size:18px;
      font-weight:1000;
      color:var(--primary-2);
    }
    .close{
      border:1px solid var(--border);
      background:#fff;
      cursor:pointer;
      border-radius: 12px;
      padding:8px 10px;
      font-weight:1000;
      color:var(--muted);
      touch-action: manipulation;
    }

    .modal-body{
      padding:14px 16px 18px;
      overflow:auto;
      -webkit-overflow-scrolling: touch;
      flex: 1 1 auto;
    }

    .progress{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:10px 12px;
      border:1px solid var(--border);
      border-radius: 14px;
      background:#fbfdff;
      margin-bottom:12px;
    }
    .progress strong{ color:var(--primary-2); font-weight:1000; }
    .bar{
      flex:1;
      height:10px;
      border-radius:999px;
      background:#eaf2fb;
      overflow:hidden;
      border:1px solid #e3edf9;
    }
    .bar > i{
      display:block;
      height:100%;
      width:0%;
      background: linear-gradient(90deg, rgba(11,95,168,.55), rgba(11,95,168,1));
      border-radius:999px;
      transition: width .25s ease;
    }

    .qwrap{
      border:1px solid var(--border);
      border-radius: 18px;
      padding:14px 14px;
      background:#fff;
    }
    .qtitle{
      margin:0 0 8px;
      font-size:16px;
      font-weight:1000;
      color:#17324a;
      white-space:pre-wrap;
    }

    .options{
      display:grid;
      grid-template-columns: 1fr;
      gap:10px;
      margin-top:10px;
    }

    .optbtn{
      text-align:right;
      width:100%;
      border:1px solid var(--border);
      background:#fff;
      border-radius: 16px;
      padding:12px 12px;
      cursor:pointer;
      font-weight:900;
      color:#233a50;
      transition: transform .10s ease, border-color .10s ease, box-shadow .10s ease, background .10s ease, opacity .10s ease;
      white-space:pre-wrap;
      touch-action: manipulation;
    }
    .optbtn:hover{
      transform: translateY(-1px);
      border-color: rgba(11,95,168,.35);
      box-shadow: 0 12px 18px rgba(11,95,168,.10);
    }
    .optbtn.selected{
      border-color: rgba(11,95,168,.65);
      box-shadow: 0 14px 22px rgba(11,95,168,.14);
      background: linear-gradient(180deg, rgba(11,95,168,.10), rgba(11,95,168,.03));
    }
    .optbtn:disabled{
      cursor: not-allowed;
      opacity: .78;
      transform:none !important;
      box-shadow:none !important;
    }

    .feedback{
      margin-top:12px;
      border:1px dashed rgba(11,95,168,.35);
      background: rgba(11,95,168,.06);
      border-radius: 16px;
      padding:12px 12px;
      display:none;
      white-space:pre-wrap;
      font-weight:800;
      color:#21415c;
    }
    .feedback.show{ display:block; }

    .status{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:8px 14px;
      border-radius:999px;
      border:1px solid rgba(11,95,168,.30);
      background:#fff;
      color:var(--primary-2);
      font-weight:1000;
      font-size:16px;
      margin-bottom:10px;
    }

    .modal-footer{
      display:flex;
      gap:10px;
      justify-content:space-between;
      padding:12px 16px 16px;
      border-top:1px solid var(--border);
      flex-wrap:wrap;
      flex: 0 0 auto;
      background:#fff;
    }
    .footer-left, .footer-right{ display:flex; gap:10px; align-items:center; }

    .result-grid{
      display:grid;
      grid-template-columns: 1fr;
      gap:14px;
      align-items:start;
    }

    .donut-wrap{
      display:flex;
      justify-content:center;
      align-items:center;
      padding:6px 0 2px;
    }
    .donut{
      width:220px;
      height:220px;
      display:block;
    }
    .donut text{
      font-family: "Cairo", sans-serif;
      font-weight:1000;
      fill: var(--primary-2);
    }
    .score-big{ font-size: 22px; }
    .score-small{ font-size: 12px; fill: var(--muted); font-weight:900; }

    .stroke-bg{ stroke: #eaf2fb; }
    .stroke-fg{ stroke: var(--primary); stroke-linecap: round; }
    .stroke-fg{
      transition: stroke-dashoffset 900ms cubic-bezier(.2,.8,.2,1);
      filter: drop-shadow(0 10px 16px rgba(11,95,168,.18));
    }

    .result-box{
      border:1px solid var(--border);
      border-radius: 18px;
      padding:14px 14px;
      background:#fbfdff;
      white-space:pre-wrap;
    }
    .result-box h4{
      margin:0 0 8px;
      font-weight:1000;
      color:#17324a;
      font-size:16px;
    }
    .result-box p{
      margin:0;
      color:#294057;
      font-weight:800;
      white-space:pre-wrap;
    }

    footer{
      margin-top:16px;
      color:var(--muted);
      text-align:center;
      font-weight:800;
      padding:14px 0 30px;
    }

    @media (min-width: 820px){
      .result-grid{ grid-template-columns: 320px 1fr; align-items:center; }
    }

    /* ===== ุชุญุณููุงุช ุงูููุจุงูู (ุตุบูุฑ) ===== */
    @media (max-width: 640px){
      .container{ width: calc(100% - 20px); }

      .topbar{ flex-direction: column; align-items: center; padding:12px 0; }
      .logo-wrap{ min-width:auto; justify-content:center; }
      .title-wrap{ text-align:center; padding:0; }
      .title{ font-size: 22px; }

      .card{ padding:16px; border-radius: 16px; }

      .actions{ gap:10px; }
      .btn{ min-width: 100%; padding:14px 14px; }

      .backdrop{ padding:10px; }
      .modal{ width: 100%; border-radius: 16px; max-height: calc(100dvh - 20px); }
      .modal-body{ padding:12px 12px 16px; }
      .progress{ flex-wrap:wrap; }
      .optbtn{ padding:14px 12px; font-size: 16px; }

      .modal-footer{ gap:10px; justify-content:space-between; }
      .footer-right{ width:100%; justify-content:space-between; }
      .footer-left{ width:100%; justify-content:space-between; }
      .btn.small{ flex:1; justify-content:center; }
      .btn.ghost.small{ flex:1; }
      .btn.primary.small{ flex:1; }
    }

    /* ===== ุงูุชุนุฏูู ุงูููู ูุดุงุดุงุช ุทูู (Portrait) ุญุชู ูู ูุงูุช ุนุฑูุถุฉ ===== */
    @media (orientation: portrait), (max-aspect-ratio: 4/5){
      .container{ width: min(920px, calc(100% - 24px)); }

      .topbar{
        flex-direction: column;
        align-items: center;
        gap:10px;
        padding:12px 0;
      }
      .logo-wrap{
        min-width:auto;
        justify-content:center;
      }
      /* ูุฎูู ุงูุนููุฏ ุงููููู ุงููู ูุณูู ุชูุณูุท ุจุงูุฏุณูุชูุจ */
      header .topbar > .logo-wrap[aria-hidden="true"]{
        display:none !important;
      }

      .title-wrap{ padding:0; }
      .title{ font-size: clamp(20px, 3.2vw, 30px); }

      .actions{
        flex-direction: column;
        align-items: stretch;
      }
      .btn{ min-width: 100%; }

      .backdrop{ padding:12px; }
      .modal{
        width: 100%;
        max-height: calc(100dvh - 24px);
      }
    }
  </style>
</head>

<body>
  <header>
    <div class="container">
      <div class="topbar">
        <div class="logo-wrap" aria-label="ุดุนุงุฑ ุงูุฅุฏุงุฑุฉ">
          <img class="header-logo" src="assets/header-logo.jpg" alt="ุดุนุงุฑ">
        </div>

        <div class="title-wrap">
          <h1 class="title">ูุณู ููุงุกุฉ ุงูุทุงูุฉ</h1>
        </div>

        <div class="logo-wrap" aria-hidden="true" style="opacity:0; pointer-events:none;">
          <img class="header-logo" src="assets/header-logo.jpg" alt="">
        </div>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="card" aria-label="ูุจุฐุฉ ุงููุณู">
      <div class="grid">
        <div>
          <h2 class="section-title">ุฑุคูุชูุง :</h2>
          <p class="section-text">
            ุชุญููู ุงูุงุณุชุฎุฏุงู ุงูุฃูุซู ููุทุงูุฉ ุนู ุทุฑูู ุฑูุน ููุงุกุฉ ุงูุทุงูุฉ ูุชุนุฒูุฒ ุงูุชูููุฉ ุงููุณุชุฏุงูุฉ.
          </p>
        </div>

        <div>
          <h2 class="section-title">ุฑุณุงูุชูุง:</h2>
          <p class="section-text">
            ุฑูุน ููุงุกุฉ ุงูุทุงูุฉ ูู ุงูุฏููุฉ ูู ุฎูุงู ุงูุชุนุงูู ูุน ุงูุฌูุงุช ุงููุนููุฉ ูุชุทููุฑ ุญููู ูุณูุงุณุงุช ูุจุชูุฑุฉ ุชุนุฒุฒ ุฑูุน ููุงุกุฉ ุงูุงุณุชููุงูุ
            ูุชุฏุนู ุงูุงุณุชุฏุงูุฉ ุงูุจูุฆูุฉุ ูุชุญูู ุฃูู ุงูุทุงูุฉ.
          </p>
        </div>
      </div>

      <div class="actions">
        <button class="btn primary" id="btnSurvey" type="button">ูููู ุนุงุฏุงุชู ูู ุงุณุชุฎุฏุงู ุงูุทุงูุฉ</button>
        <button class="btn" id="btnQuiz" type="button">ุดูู ุชุนุฑู ุนู ููุงุกุฉ ุงูุทุงูุฉ</button>
      </div>
    </section>

    <footer>
      ยฉ ูุณู ููุงุกุฉ ุงูุทุงูุฉ โ ูุฒุงุฑุฉ ุงูููุฑุจุงุก ูุงููุงุก ูุงูุทุงูุฉ ุงููุชุฌุฏุฏุฉ โ ุฏููุฉ ุงููููุช
    </footer>
  </main>

  <div class="backdrop" id="backdrop" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" role="document" aria-label="ูุงูุฐุฉ ููุจุซูุฉ">
      <div class="modal-header">
        <h3 class="modal-title" id="modalTitle">ุนููุงู</h3>
        <button class="close" id="btnClose" type="button" aria-label="ุฅุบูุงู">โ</button>
      </div>

      <div class="modal-body" id="modalBody"></div>

      <div class="modal-footer" id="modalFooter">
        <div class="footer-left">
          <button class="btn ghost small" id="btnPrev" type="button">ุงูุณุงุจู</button>
        </div>
        <div class="footer-right">
          <button class="btn small" id="btnCancel" type="button">ุฅูุบุงุก</button>
          <button class="btn primary small" id="btnNext" type="button">ุงูุชุงูู</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const survey = {
      title: "ูููู ุนุงุฏุงุชู",
      questions: [
        {
          q: "ูก- ุฅุฐุง ูุงูุช ุฃุดุนุฉ ุงูุดูุณ ูุจุงุดุฑุฉ ุนูู ุงููุงุฌูุฉุ ุดูู ุงูุฅุฌุฑุงุก ุงูุฃูุถูุ",
          options: ["ุฃุฒูุฏ ุงูุชุจุฑูุฏ","ุชุธููู ู ุนุฒู","ุฃูุชุญ ุงูุจุงุจ","ุฃุบููุฑ ููู ุงูุฃุซุงุซ"],
          correct: 1,
          explanation: "ุชูุถูุญ: ุชูููู ุงูุญุฑุงุฑุฉ ุงูุฏุงุฎูุฉ (ุจุงูุชุธููู ุฃู ุงูุนุฒู) ูุฎูู ุงูุญูู ุนูู ุงูููููู.",
          note: "ููุงุญุธุฉ: ุฒูุงุฏุฉ ุงูุชุจุฑูุฏ ุชุนุงูุฌ ุงููุชูุฌุฉ ููุง ุชุญู ุงููุดููุฉ ููุง ูุณุจุจ ุงุฑุชูุงุน ูู ุงููุงุชูุฑุฉ."
        },
        {
          q: "ูข-ุดูู ูุฑุงุฑู ูุน ุงูุฃุฌูุฒุฉ ุงููุฏููุฉ ุนุงููุฉ ุงูุงุณุชููุงูุ",
          options: ["ุฃุญุชูุธ ูููุง","ุฃุจุฏูููุง ุจุฌูุงุฒ ุฃููุฃ ุฅุฐุง ุฃููู","ุฃุณุชุฎุฏููุง ุฃูุซุฑ","ุฃุตูุญูุง ุจุฏูู ุชูููุฑ ุจุงูููุงุกุฉ"],
          correct: 1,
          explanation: "ุงุณุชุจุฏุงู ุงูุฃุฌูุฒุฉ ุงููุฏููุฉ ุจุฃุฌูุฒุฉ ุฐุงุช ููุงุกุฉ ุนุงููุฉ ูููู ุงูุงุณุชููุงู ุจุดูู ููุญูุธ.",
          note: ""
        },
        {
          q: "ูฃ- ุฃู ุฃุณููุจ ุฃูุฑุจ ูุนุงุฏุงุชู ุงูููููุฉุ",
          options: ["ุฃุฌูุฒุฉ ุฐุงุช ููุงุกุฉ ุนุงููุฉ+ ุชุดุบูู ูุงุนู","ุฃุฌูุฒุฉ ุฐุงุช ููุงุกุฉ ุนุงููุฉ ููุท","ุชุดุบูู ูุงุนู ููุท","ูุง ุฃุบููุฑ ุดู"],
          correct: 0,
          explanation: "ุชูุถูุญ: ุฃูุถู ูุชูุฌุฉ ุชุชุญูู ูู ุงูุฌูุน ุจูู ุงูุชูููุฉ ุงูุฌูุฏุฉ ูุงูุณููู ุงูุตุญูุญ.",
          note: "ููุงุญุธุฉ: ุงูุงุนุชูุงุฏ ุนูู ุนุงูู ูุงุญุฏ ูุนุทู ูุชูุฌุฉ ุฃูู."
        },
        {
          q: "ูค- ุจุงูุฃูุงูู ุงููู ูุง ุชุณุชุฎุฏู ุจุดูู ูุณุชูุฑ (ูุซู ุงููุฎุงุฒู ุฃู ุงูุณูุงูู)ุ ุดูู ุงูุญู ุงูุฃูุฑุจ ููููุงุกุฉุ",
          options: ["ุชุดุบูู ุงูุฅุถุงุกุฉ ุทูุงู ุงูููุช","ุงูุงุนุชูุงุฏ ุนูู ุงูุชุฐููุฑ ุงููุฏูู"," ุชุฑููุจ motion sensors/ Occupancy Sensors ููุฅุถุงุกุฉ","ุฒูุงุฏุฉ ุนุฏุฏ ุงููุตุงุจูุญ"],
          correct: 2,
          explanation: "ุชูุถูุญ :ุญุณุงุณุงุช ุงูุญุฑูุฉ ุชุดุบูู ุงูุฅุถุงุกุฉ ููุท ุนูุฏ ูุฌูุฏ ุฃุดุฎุงุตุ ูุชููุน ุงููุฏุฑ ูู ุงูุฃูุงูู ููููุฉ ุงูุงุณุชุฎุฏุงู.",
          note: "ููุงุญุธุฉ: ููุถู ุงุณุชุฎุฏุงู ุงูmotion sensors ููููุฑุงุช ุงูุง ุจุงููุณุจู ู occupancy sensors ููููุงุชุจ"
        },
        {
          q: "ูฅ- ุงุฐุง ุชุจู ุชุฑูุน ููุงุกุฉ ุงูุทุงูุฉ ูู ุจูุชู:",
          options: ["ุชุณูุฑ ุงูุงุถุงุกู","ุชุฑูุจ LED","ุงุณุชุฎุฏุงู ููุจุงุช ูููุฉ ุฌุฏูุง ูู ุฌููุน ุงูุบุฑู"],
          correct: 1,
          explanation: "ุฅุทูุงุก ุงูุฅุถุงุกุฉ ูู ุงูุฃูุงูู ุบูุฑ ุงููุณุชุฎุฏูุฉ ูุณุงูู ูู ุฎูุถ ุงูุงุณุชููุงู ุบูุฑ ุงูุถุฑูุฑูุ ุฅููุง ุงุณุชุจุฏุงููุง ุจูุตุงุจูุญ ูููุฑุฉ ููุทุงูุฉ ูุซู ุงู LED ูุนุชุจุฑ ูู ููุงุฑุณุงุช ุฑูุน ููุงุกุฉ ุงูุทุงูุฉ.",
          note: ""
        },
        {
          q: "ูฆ-ุนูุฏ ุงุฎุชูุงุฑู ููุฃุฌูุฒุฉ ุงูููุฑุจุงุฆูุฉุ ุดูู ุงููุฑุงุฑ ุงูุฃูุฑุจ ูุนุงุฏุงุชูุ",
          options: ["ุฃุฎุชุงุฑ ุงูุฃุฑุฎุต ุจุฏูู ุงููุธุฑ ููููุงุกุฉ","ุฃุฑููุฒ ุนูู ุงูุญุฌู ุฃู ุงูููุฉ ููุท","ุฃุฑุงุฌุน ุจุทุงูุฉ ููุงุกุฉ ุงูุทุงูุฉ ูุฃุฎุชุงุฑ ุงูุฃุนูู ููุงุกุฉ","ุฃุฎุชุงุฑ ุญุณุจ ุงูุดูู ุฃู ุงูุนูุงูุฉ ุงูุชุฌุงุฑูุฉ"],
          correct: 2,
          explanation: "ุชูุถูุญ: ุจุทุงูุฉ ููุงุกุฉ ุงูุทุงูุฉ ุชูุถุญ ุงุณุชููุงู ุงูุฌูุงุฒ ููููุฑุจุงุก ูุชุณุงุนุฏู ุชุฎุชุงุฑ ุฌูุงุฒ ุฃููุฑ ูู ุงูุชุดุบููุ ูุนูู ุชููุฑ ุนูู ุงููุงุชูุฑุฉ ูุชุญุงูุธ ุนูู ุงูุทุงูุฉ.",
          note: ""
        },
        {
          q: "ูง-ุดูู ุฑุฃูู ุจุงูุฃูุธูุฉ ุงูุฐููุฉ ูู ุงููุจุงููุ",
          options: ["ููุงููุงุช ููุท","ููุฑุงุญุฉ ุฃูุซุฑ ูู ุงูููุงุกุฉ","ุฃุฏุงุฉ ูุนูุงูุฉ ูุฑูุน ููุงุกุฉ ุงูุทุงูุฉ","ูุง ููุง ุชุฃุซูุฑ"],
          correct: 2,
          explanation: "ุชูุถูุญ:\nุงูุชุญูู ุงูุฐูู ููููู ุงูุชุดุบูู ุบูุฑ ุงูุถุฑูุฑู.",
          note: ""
        },
        {
          q: "ูจ- ูุจู ูุง ุชุดุชุฑู ุงููููู ุดูู ุงููุฑุงุฑ ุงูุฃูุฑุจ ุงููู ุชุณููู ุ",
          options: ["ุชุญุฏูุฏ ุงูุณุนุฉ ุงูููุงุณุจุฉ ููุณุงุญุฉ ุงูุบุฑูุฉ.","ุงุดูู ุณุนุฑ ุงูุฌูุงุฒ .","ุจูุฏ ุงูุชุตููุน.","ููู ุงูุฌูุงุฒ ."],
          correct: 0,
          explanation: "ุชูุถูุญ : ุชุญุฏูุฏ ุงูุณุนุฉ ุงูููุงุณุจุฉ ููุณุงุญุฉ ุงูุบุฑูุฉ ุชุถูู ูููู ููุงุณุจ ุงุญุชูุงุฌู ู ูุญูู ุงูุงุณุชุฎุฏุงู ุงูุฃูุซู ููุทุงูุฉ.",
          note: ""
        },
        {
          q: "ูฉ- ุชุชููุน ููุด ูุงููููู ุงุฑูุน ุฏุฑุฌุฉ ุญุฑุงุฑุฉ ุงูุชูููู ุนุดุงู ุชุฑูุน ูู ููุงุกุฉ ุงูุทุงูุฉุ",
          options: ["ุนุดุงู ูุงูุฎุชุฑุจ ุงููููู","ุนุดุงู ุงูููุงุก ูุตูุฑ ุฃูุธู ุงุฐุง ุฎูููุงู ุฃุจุฑุฏ","ูุงู ููุงุกุฉ ุงูุทุงูุฉ ุชุนุชูุฏ ุนูู ุงูุงุฌูุฒู ุนุงููุฉ ุงูููุงุกุฉ ูู ุชูููู ุฑุงุญุฉ ุงููุณุชุฎุฏู","ูุงู ุงูููุงุกุฉ ุชุนูู ุชูููู ุงูุฑุงุญู"],
          correct: 2,
          explanation: "ุงููุฏู ูู ููุงุกุฉ ุงูุทุงูุฉ ูู ุชูููู ุงูุงุณุชููุงู ูู ุบูุฑ ุชูููู ุฑุงุญุฉ ุงููุฑุฏ ููู ุงูุจุฏุงูุฉ ุงุญุฑุต ุนูู ุงูู ุชุฎุชุงุฑ ุฃุฌูุฒู ูููุฑุฉ ููุทุงูุฉ ุจุฏูู ูุง ุชุฃุซุฑ ุนูู ุฑุงุญุชู ุงูุดุฎุตูุฉ",
          note: ""
        },
        {
          q: "ูกู- ุชููุฑ ุชุญุท ุซุฑููุณุชุงุช ุฐูู ููุชุญูู ุจุฏุฑุฌุงุช ุญุฑุงุฑุฉ ุงูููููุ",
          options: ["ูุงูู ุฏุงุนู","ุงู ุฑุงุญ ูุณุงุนุฏูู ุงููุฑ ุจุงูุทุงูุฉ ุงูููุฑุจุงุฆูุฉ","ูุงุญุจ ุงูุชูููููุฌูุง","ุดูู ูุงูุฏุชูุ"],
          correct: 1,
          explanation: "ุงูุซุฑููุณุชุงุช ุงูุฐูู ูุณุงุนุฏู ุชุชุญูู ุจุฏุฑุฌุงุช ุญุฑุงุฑุฉ ุงูุชูููู ุญุณุจ ุงุญุชูุงุฌู ูุงูุฃููุงุช ุงููู ุชููู ูููุง ุจุงูุจูุชุ ููุฐุง ูุณุงูู ูู ุฑูุน ููุงุกุฉ ุงูุฌูุงุฒ ูุชุทููู ุนูุฑู ุงูุงูุชุฑุงุถู",
          note: ""
        }
      ]
    };

    const quiz = {
      title: "ุดูู ุชุนุฑู ุนู ููุงุกุฉ ุงูุทุงูุฉ",
      questions: [
        {
          q: "ูก-ุฅุฐุง ูุงุชูุฑุฉ ุจูุชู ุงูุดูุฑูุฉ ููููุฑุจุงุก ูฅู ุฏููุงุฑุ ุฌู ุชุชููุน ูุจูุบ ุงูุฏุนู ุงูุญูููู ุชูุฑูุจุงู ูููุณ ุงูุงุณุชููุงูุ",
          options: ["ูกูงูฅ","ูคูงูฅ","ูฅูงูฅ","ูฉูงูฅ"],
          correct: 3,
          correctFeedback:
`ุงูุตุฏูุช ุตุญ! 

ูุงู ุงูููุฑุจุงุก ูุฏุนููุฉ ูููุทุงุน ุงูุณููู ูุซู ุจูุชูู ุงูุช ุชุฏูุน ูข ููุณ ููู ุงูุชูููุฉ ุงูููุงุฆูุฉ ูุงูุชุงุฌ ูู ูููููุงุท ุณุงุนุฉ ูุนุงุฏู ูคูก ููุณ

ูููู ูุจุฏุฃ ุฏูุฑูุง ุนู ุทุฑูู ุฑูุน ููุงุกุฉ ุงูุทุงูุฉ ูู ุงูุจุฏุงูุฉ ูุชุญุณูู ุงูุงุณุชููุงู ูู ุบูุฑ ูุง ูููู ุฑุงุญุฉ ุงููุฑุฏ`,
          wrongFeedback:
`ูุจูุบ ุงูุฏุนู ุงูุญูููู ุชูุฑูุจุงู ูููุณ ุงูุงุณุชููุงู ููุตู ุญูุงููู ูฉูงูฅ ุฏููุงุฑ.

ูุงู ุงูููุฑุจุงุก ูุฏุนููุฉ ูููุทุงุน ุงูุณููู ูุซู ุจูุชูู ุงูุช ุชุฏูุน ูข ููุณ ููู ุงูุชูููุฉ ุงูููุงุฆูุฉ ูุงูุชุงุฌ ูู ูููููุงุท ุณุงุนุฉ ูุนุงุฏู ูคูก ููุณ

ูููู ูุจุฏุฃ ุฏูุฑูุง ุนู ุทุฑูู ุฑูุน ููุงุกุฉ ุงูุทุงูุฉ ูู ุงูุจุฏุงูุฉ ูุชุญุณูู ุงูุงุณุชููุงู ูู ุบูุฑ ูุง ูููู ุฑุงุญุฉ ุงููุฑุฏ`
        },
        {
          q: "ูข- ุดูู ูุนูู ุชุตููู ููุงุกุฉ ุงูุทุงูุฉ ( ูุซู A+,A++)ุ",
          options: ["ุฃ) ุญุฌู ุงูุฌูุงุฒ","ุจ) ุณุฑุนุฉ ุงูุฌูุงุฒ","ุฌ) ูููุฉ ุงูุทุงูุฉ ุงููู ูุณุชููููุง ุงูุฌูุงุฒ","ุฏ) ูุณุชูู ุงูุถูุถุงุก"],
          correct: 2,
          correctFeedback: "ุตุญ ๐๐ป ุ ุชุตููู ููุงุกุฉ ุงูุทุงูุฉ ูุจููู ููุฏุงุฑ ุงุณุชููุงู ุงูุฌูุงุฒ ููููุฑุจุงุกุ ููู ูุง ูุงู ุงูุชุตููู ุฃุนูู ูุงู ุงูุฌูุงุฒ ุฃููุฑ ูู ุงูุชุดุบูู ููููุฑ ุนูู ุงููุงุชูุฑุฉ.",
          wrongFeedback: "ุบูุท ุ ุชุตููู ููุงุกุฉ ุงูุทุงูุฉ ูุจููู ุงุณุชููุงู ุงูููุฑุจุงุก ููุทุ ูููุณ ุญุฌู ุงูุฌูุงุฒ ุฃู ุณุฑุนุชู ุฃู ุตูุชู."
        },
        {
          q: "ูฃ- ููุง ุชุดุชุฑู ุฌูุงุฒ ููุฑุจุงุฆู ุฌุฏูุฏุ ุดูู ุฃูู ุดู ุชุฑูุฒ ุนููู ุนุดุงู ุชููุฑ ููุฑุจุงุกุ",
          options: ["ุฃ) ุงูุดูู","ุจ) ุจุทุงูุฉ ููุงุกุฉ ุงูุทุงูุฉ","ุฌ) ุงูุญุฌู","ุฏ) ุงูุณุนุฑ"],
          correct: 1,
          correctFeedback: "ุตุญ ๐๐ป ุ ุจุทุงูุฉ ููุงุกุฉ ุงูุทุงูุฉ ุชูุถุญ ุงุณุชููุงู ุงูุฌูุงุฒ ููููุฑุจุงุก ูุชุณุงุนุฏู ุชุฎุชุงุฑ ุฌูุงุฒ ุฃููุฑ ูู ุงูุชุดุบููุ ูุนูู ุชููุฑ ุนูู ุงููุงุชูุฑุฉ ูุชุญุงูุธ ุนูู ุงูุทุงูุฉ.",
          wrongFeedback: "ุบูุท ุ ุงูุดูู ุฃู ุงูุญุฌู ุฃู ุงูุณุนุฑ ูุง ูุญุฏุฏูู ุงุณุชููุงู ุงูููุฑุจุงุกุ ุจุทุงูุฉ ููุงุกุฉ ุงูุทุงูุฉ ูู ุงููุคุดุฑ ุงูุญูููู ููุชูููุฑ."
        },
        {
          q: "ูค- ุฅุฐุง ูุงู ุนูุฏู ุฌูุงุฒูู ูุฏุฑุชูู 1000 ูุงุทุ ูู ูุฐุง ูุนูู ุฅููู ููุณ ุงูููุงุกุฉุ",
          options: ["ูุนูุ ูุฃู ุงููุฏุฑุฉ ููุณูุง","ูุนูุ ูุฃู ุงุณุชููุงููู ูุชุณุงูู","ูุงุ ุงูููุงุกุฉ ุชุนุชูุฏ ุนูู ุงูุฃุฏุงุก ููุงุจู ุงูุทุงูุฉ ุงููุณุชูููุฉ","ูุนุชูุฏ ุนูู ููู ุงูุฌูุงุฒ"],
          correct: 2,
          correctFeedback: "ููุงุญุธู : ุงูููุงุกุฉ ุชููุณ ุดูุซุฑ ูุนุทู ุงูุฌูุงุฒ ุฃุฏุงุก ููุงุจู ุงูุทุงูุฉุ ูู ุจุณ ุฑูู ุงููุงุท.",
          wrongFeedback: "ููุงุญุธู : ุงูููุงุกุฉ ุชููุณ ุดูุซุฑ ูุนุทู ุงูุฌูุงุฒ ุฃุฏุงุก ููุงุจู ุงูุทุงูุฉุ ูู ุจุณ ุฑูู ุงููุงุท."
        },
        {
          q: "ูฅ-ุดูู ุฃูุซุฑ ูุงุฌูุฉ ูู ุงููุจูู ุงููู ูููุถููู ุชูููู ุงุณุชุฎุฏุงู ุงูุฒุฌุงุฌ ูููุง ูุชุฎููู ุฏุฎูู ุงูุญุฑุงุฑุฉุ",
          options: ["ุงูุดูุงููุฉ","โุงูุฌููุจูุฉ","โุงูุดุฑููุฉ","โุงูุบุฑุจูุฉ"],
          correct: 1,
          correctFeedback: "ุตุญ ๐๐ป ุ ุงููุงุฌูุฉ ุงูุฌููุจูุฉ ุชุชุนุฑูุถ ููุดูุณ ุจุดูู ูุจุงุดุฑุ ูุฒูุงุฏุฉ ุงูุฒุฌุงุฌ ูููุง ุชุฑูุน ุฏุฎูู ุงูุญุฑุงุฑุฉ.",
          wrongFeedback: "ุบูุท ุ ุงููุงุฌูุฉ ุงูุฃูุซุฑ ุชุนุฑุถุงู ูุญุฑุงุฑุฉ ุงูุดูุณ ูู ุงูุฌููุจูุฉ."
        },
        {
          q: "ูฆ- ุฃู ูุณุงุญุฉ  ูููุตุญ ุจุนุฒููุง ุญุฑุงุฑูุงู ูุชูููู ุงูุชุฃุซูุฑ ุงูุญุฑุงุฑู ุนูู ุงููุจููุ",
          options: ["ุงูุณุทุญ","โุงูุฌุฏุฑุงู ุงูุฏุงุฎููุฉ","โุงููุดุฑุจูุงุช","โุฌููุน ูุง ุณุจู ุตุญูุญ"],
          correct: 0,
          correctFeedback: "ุตุญ ๐๐ปุ ุงูุณุทุญ ูู ุฃูุซุฑ ุฌุฒุก ูุชุนุฑูุถ ููุดูุณุ ูุนุฒูู ููููู ุงูุญุฑุงุฑุฉ ุงูุฏุงุฎูุฉ ูููุจูู ุจุดูู ูุจูุฑ.",
          wrongFeedback: "ุบูุท ุ ุงูุนุฒู ุงูุญุฑุงุฑู ูููู ููุฃุฌุฒุงุก ุงููุนุฑูุถุฉ ููุฎุงุฑุฌุ ูููุณ ูููุณุงุญุงุช ุงูุฏุงุฎููุฉ."
        },
        {
          q: "ูง- ุดูู ุฃูุซุฑ ุดู ูููู ุงุณุชููุงู ุงูููุฑุจุงุก: ุงูุนุฒู ุงูุญุฑุงุฑู ููุง ููุงุกุฉ ุงููููููุ",
          options: ["ุฃ) ุงูุนุฒู ููู ูููู ูู ุงูุนุงูู ุงูุฃุณุงุณู","ุจ) ููุงุกุฉ ุงูููููู ุฃูู ูู ุงูุนุฒู","ุฌ) ุงูุงุซููู ููููู ุจุณ ุงูุนุฒู ุชุฃุซูุฑู ุฃูุจุฑ","ุฏ) ุงูุงุซููู ููููู ุจููุณ ุงูุฏุฑุฌุฉ"],
          correct: 2,
          correctFeedback:
`ุตุญ ๐๐ปุ ุงูุนุฒู ูููู ุงูุญูู ูู ุงูุฃุณุงุณ ุ ูุนูู ุจุฏู ูุง ุชูุจูุฑ ุงูููููู ุนุดุงู ูุนุงูุฌ ุงููุดููุฉุ ุฃูุช ุชููุน ุงููุดููุฉ ูู ุงูุจุฏุงูุฉ.`,
          wrongFeedback:
`ุบูุท ุ ุชุญุณูู ุงูุฃุฌูุฒุฉ ุจุฏูู ุนุฒู ูุนุงูุฌ ุงููุชูุฌุฉ ูู ุงูุณุจุจ.`
        },
        {
          q: "ูจ- ูู ูููู ุงูู VFD / Inverter ูุนูุงู ูููู ุงุณุชููุงู ุงูููุฑุจุงุกุ",
          options: ["ุฃ) ุฅูุ ูููุฑ ุชูุฑูุจูุง 20%โ40%","ุจ) ุฅูุ ุจุณ ุฃูู ูู 20%","ุฌ) ุงููุฑู ุจุณูุท ุฌุฏูุง","ุฏ) ูุงุ ูุง ูููุฑ ููุฑุจุงุก"],
          correct: 0,
          correctFeedback:
`ุตุญ ๐๐ป ุ ููููู ุงูู Inverter ูุถุจุท ุณุฑุนุชู ุญุณุจ ุงูุญุงุฌุฉุ ูููููุฑ ุชูุฑูุจูุง 20%โ40% ูู ุงูููุฑุจุงุก.
ู ุชุฏุฑู ุงู ูู ูุฑุงุฑ ุฅูุฒุงูู ูู ุงููุฒุงุฑุฉ ูุฌููุน ุงููุจุงูู ุงูุฌุฏูุฏุฉ ุชุฑูุจ inverter MSU`,
          wrongFeedback:
`ููููู ุงูู Inverter ูุถุจุท ุณุฑุนุชู ุญุณุจ ุงูุญุงุฌุฉุ ูููููุฑ ุชูุฑูุจูุง 20%โ40% ูู ุงูููุฑุจุงุก.
ู ุชุฏุฑู ุงู ูู ูุฑุงุฑ ุฅูุฒุงูู ูู ุงููุฒุงุฑุฉ ูุฌููุน ุงููุจุงูู ุงูุฌุฏูุฏุฉ ุชุฑูุจ inverter MSU`
        },
        {
          q: "ูฉ- ุดููู ุงูุฃูุธูุฉ ุงูุฐููุฉ ุชููู ุงุณุชููุงู ุงูููุฑุจุงุก ูู ุงููุจุงููุ",
          options: ["ุฃ) ุชุถุจุท ุงูุชุดุบูู ุญุณุจ ุงูุญุงุฌุฉ","ุจ) ุชุญุณู ุฃุฏุงุก ุงูุฃุฌูุฒุฉ ุจุณ","ุฌ) ุชุทูุฆ ุงูุฃูุธูุฉ ุจุดูู ุนุดูุงุฆู","ุฏ) ุจุณ ุชุฑุงูุจ ุจุฏูู ุชุฃุซูุฑ"],
          correct: 0,
          correctFeedback: "ุตุญ ๐๐ป ุ ุงูุฃูุธูุฉ ุงูุฐููุฉ ุชุดุบูู ุงูุฃุฌูุฒุฉ ููุช ุงูุญุงุฌุฉ ููุทุ ูุชูููู ุงููุฏุฑ ูู ุงูุทุงูุฉ.",
          wrongFeedback: "ุบูุท ุ ุงูุชูููุฑ ูููู ูู ุงูุชุญูู ุงูุฐููุ ูู ูู ุงูุฅุทูุงุก ุงูุนุดูุงุฆู ุฃู ุงููุฑุงูุจุฉ ููุท."
        },
        {
          q: "ูกู- ุดูู ุงูุซุฑ ุดู ููู:",
          options: ["ูก- ุงุบูุฑ ุณูููู ูุงุญุงูุธ ุนูู ุงูุทุงูุฉ","ูข-ุงุฑูุน ููุงุกุฉ ุงูุทุงูุฉ","ูฃ-ุงุฑูุจ ุทุงูุฉ ูุชุฌุฏุฏุฉ","ูค- ุฌููุน ูุง ุณุจู"],
          correct: 3,
          correctFeedback:
`ูููู ูููููู ุจุนุถุ ูู ุงูุจุฏุงูุฉ ูุงุฒู ุงุบูุฑ ุณูููู ุนุดุงู ุงุญุงูุธ ุนูู ุงูุทุงูุฉ ุงูููุฑุจุงุฆูุฉ ูุงุณุงูู ูู ุฑูุน ููุงุกุฉ ุงูุทุงูุฉ ุจุงุนุชุจุงุฑูุง ุฎุทูุฉ ุฃุณุงุณูุฉ ููุชุญูู ุฅูู ูุตุงุฏุฑ ุงูุทุงูุฉ ุงููุชุฌุฏุฏุฉ ุจุชูุงููู ุฃูููุฉ ููุฎูุถุฉ ุญุณุจ ุงูุงุญุชูุงุฌ ุงููุนูู`,
          wrongFeedback:
`ูููู ูููููู ุจุนุถุ ูู ุงูุจุฏุงูุฉ ูุงุฒู ุงุบูุฑ ุณูููู ุนุดุงู ุงุญุงูุธ ุนูู ุงูุทุงูุฉ ุงูููุฑุจุงุฆูุฉ ูุงุณุงูู ูู ุฑูุน ููุงุกุฉ ุงูุทุงูุฉ ุจุงุนุชุจุงุฑูุง ุฎุทูุฉ ุฃุณุงุณูุฉ ููุชุญูู ุฅูู ูุตุงุฏุฑ ุงูุทุงูุฉ ุงููุชุฌุฏุฏุฉ ุจุชูุงููู ุฃูููุฉ ููุฎูุถุฉ ุญุณุจ ุงูุงุญุชูุงุฌ ุงููุนูู`
        }
      ]
    };

    const backdrop = document.getElementById("backdrop");
    const modalTitle = document.getElementById("modalTitle");
    const modalBody  = document.getElementById("modalBody");
    const modalFooter = document.getElementById("modalFooter");

    const btnSurvey = document.getElementById("btnSurvey");
    const btnQuiz = document.getElementById("btnQuiz");
    const btnClose = document.getElementById("btnClose");
    const btnCancel = document.getElementById("btnCancel");
    const btnPrev = document.getElementById("btnPrev");
    const btnNext = document.getElementById("btnNext");

    let active = null;
    let step = 0;
    let answers = [];
    let locked = [];

    function openModal(payload){
      active = payload;
      step = 0;
      answers = new Array(active.questions.length).fill(null);
      locked  = new Array(active.questions.length).fill(false);

      modalTitle.textContent = payload.title;
      renderStep();

      backdrop.classList.add("open");
      backdrop.setAttribute("aria-hidden", "false");
      btnClose.focus();

      document.body.style.overflow = "hidden";
    }

    function closeModal(){
      backdrop.classList.remove("open");
      backdrop.setAttribute("aria-hidden", "true");
      active = null;
      document.body.style.overflow = "";
    }

    function stripLeadingWrong(text){
      if (!text) return text;
      return String(text).replace(/^\s*ุบูุท\s*[\.ุ:!ุโฆ]*\s*/u, "");
    }

    function showFeedback(item, chosenIdx){
      const fb = document.getElementById("feedback");
      const isQuizMode = Object.prototype.hasOwnProperty.call(item, "correctFeedback");

      if (isQuizMode){
        const isCorrect = (chosenIdx === item.correct);
        const label = isCorrect ? "ุตุญ" : "ุบูุท";
        let text = isCorrect ? (item.correctFeedback || "") : (item.wrongFeedback || "");
        if (!isCorrect) text = stripLeadingWrong(text);

        fb.innerHTML = `<div class="status">${label}</div>\n${escapeHtml(text)}`;
        fb.classList.add("show");
        return;
      }

      const parts = [];
      if ((item.explanation || "").trim()) parts.push(item.explanation);
      if ((item.note || "").trim()) parts.push(item.note);

      if (parts.length === 0){
        fb.classList.remove("show");
        fb.textContent = "";
        return;
      }

      fb.textContent = parts.join("\n\n");
      fb.classList.add("show");
    }

    function renderStep(){
      const total = active.questions.length;

      if (step >= total){
        renderResult();
        return;
      }

      const item = active.questions[step];
      const progressPct = Math.round(((step) / total) * 100);

      modalFooter.style.display = "flex";
      btnPrev.disabled = (step === 0);
      btnNext.textContent = (step === total - 1) ? "ุฅููุงุก" : "ุงูุชุงูู";
      btnNext.disabled = (answers[step] === null);

      modalBody.innerHTML = `
        <div class="progress">
          <strong>ุณุคุงู ${step + 1} ูู ${total}</strong>
          <div class="bar"><i id="barFill"></i></div>
          <span style="color:var(--muted); font-weight:900;">${progressPct}%</span>
        </div>

        <div class="qwrap">
          <h4 class="qtitle">${escapeHtml(item.q)}</h4>
          <div class="options" id="options"></div>
          <div class="feedback" id="feedback"></div>
        </div>
      `;

      document.getElementById("barFill").style.width = `${progressPct}%`;

      const optionsDiv = document.getElementById("options");
      item.options.forEach((opt, idx) => {
        const b = document.createElement("button");
        b.type = "button";
        b.className = "optbtn";
        b.textContent = opt;

        if (answers[step] === idx) b.classList.add("selected");
        if (locked[step]) b.disabled = true;

        b.addEventListener("click", () => {
          if (locked[step]) return;

          answers[step] = idx;
          locked[step] = true;

          [...optionsDiv.querySelectorAll(".optbtn")].forEach(x => x.classList.remove("selected"));
          b.classList.add("selected");
          [...optionsDiv.querySelectorAll(".optbtn")].forEach(x => x.disabled = true);

          btnNext.disabled = false;
          showFeedback(item, idx);
        });

        optionsDiv.appendChild(b);
      });

      if (answers[step] !== null){
        showFeedback(item, answers[step]);
        if (locked[step]){
          [...optionsDiv.querySelectorAll(".optbtn")].forEach(x => x.disabled = true);
        }
      }
    }

    function computePct(){
      const total = active.questions.length;
      let correctCount = 0;
      for (let i=0;i<total;i++){
        if (answers[i] === active.questions[i].correct) correctCount++;
      }
      return Math.round((correctCount / total) * 100);
    }

    function resultTextByPct(pct){
      if (pct >= 90){
        return {
          title: "ูุจุฏุน ูู ููุงุกุฉ ุงูุทุงูุฉ",
          body:
`ุนุงุฏุงุชู ูู ุงุณุชุฎุฏุงู ุงูุทุงูุฉ ููุชุงุฒุฉ ุฌุฏูุง ๐
ูุงุถุญ ุฅูู ุชุฌูุน ุจูู ุงูุงุฎุชูุงุฑ ุงูุตุญูุญ ููุฃุฌูุฒุฉ ูุงูุณููู ุงููุงุนู ูู ุงูุงุณุชุฎุฏุงู.
ุจูุงูุทุฑููุฉ ุฃูุช ุชุณุงูู ูู ุชูููู ุงูุงุณุชููุงูุ ุชุฎููู ุงูุฃุญูุงูุ ูุงููุญุงูุธุฉ ุนูู ุงูุทุงูุฉ ุจุฏูู ูุง ุชุฃุซุฑ ุนูู ุฑุงุญุชู.`
        };
      }
      if (pct >= 75){
        return {
          title: "ูุณุชูู ููุชุงุฒ",
          body:
`ุนุงุฏุงุชู ูู ููุงุกุฉ ุงูุทุงูุฉ ููุชุงุฒุฉ ๐
ุนูุฏู ูุนู ูุงุถุญ ูู ูุซูุฑ ูู ุงูููุงุฑุณุงุชุ ููุน ุจุนุถ ุงูุชุญุณููุงุช ุงูุจุณูุทุฉ ุชูุฏุฑ ุชูุตู ููุงุณุชุฎุฏุงู ุงูุฃูุซู ููุทุงูุฉ ูุชุญูู ุชูููุฑ ุฃูุจุฑ ุนูู ุงููุฏู ุงูุทููู.`
        };
      }
      if (pct >= 60){
        return {
          title: "ูุณุชูู ุฌูุฏ",
          body:
`ุนุงุฏุงุชู ูู ููุงุกุฉ ุงูุทุงูุฉ ุฌูุฏุฉุ ููู ูู ูุฌุงู ููุชุทููุฑ.
ุชุญุณูู ุจุนุถ ุงููุฑุงุฑุงุช ูุซู ุงุฎุชูุงุฑ ุงูุฃุฌูุฒุฉ ุงูุฃููุฃ ุฃู ุชูุธูู ุงูุชุดุบูู ุฑุงุญ ููุฑู ุจุดูู ูุงุถุญ ูู ุชูููู ุงูุงุณุชููุงู ูุฑูุน ููุงุกุฉ ุงูุทุงูุฉ ูู ุจูุชู.`
        };
      }
      if (pct >= 40){
        return {
          title: "ูุญุชุงุฌ ุชุญุณูู",
          body:
`ุงุณุชุฎุฏุงูู ููุทุงูุฉ ูุญุชุงุฌ ุจุนุถ ุงููุฑุงุฌุนุฉ.
ูุซูุฑ ูู ุงูููุงุฑุณุงุช ุงูููููุฉ ูููู ุชุชุนุฏู ุจุณูููุฉ ุจุฏูู ุฃู ุชุฃุซูุฑ ุนูู ุฑุงุญุชูุ ููููุง ุชุณุงูู ุจุดูู ูุจูุฑ ูู ุชูููู ุงููุฏุฑ ูุฑูุน ููุงุกุฉ ุงูุงุณุชููุงู.`
        };
      }
      return {
        title: "ุจุญุงุฌุฉ ุฅูู ูุนู ุฃูุจุฑ",
        body:
`ูุณุชูู ููุงุกุฉ ุงูุทุงูุฉ ุนูุฏู ููุฎูุถ ุญุงูููุง.
ุงูุจุฏุงูุฉ ุชููู ูู ุฎุทูุงุช ุจุณูุทุฉ ูุซู ุงุฎุชูุงุฑ ุงูุฃุฌูุฒุฉ ุงูุฃุนูู ููุงุกุฉ ูุชูุธูู ุงูุงุณุชุฎุฏุงูุ ููุน ุงูููุช ุฑุงุญ ุชูุงุญุธ ูุฑู ูุงุถุญ ูู ุงูุงุณุชููุงู ูุงููุงุชูุฑุฉ ุจุฏูู ูุง ุชูู ุฑุงุญุชู.`
      };
    }

    function renderResult(){
      const pct = computePct();
      const msg = resultTextByPct(pct);

      const r = 78;
      const c = 2 * Math.PI * r;
      const dash = (pct / 100) * c;

      modalFooter.style.display = "none";

      modalBody.innerHTML = `
        <div class="result-grid">
          <div class="donut-wrap">
            <svg class="donut" viewBox="0 0 200 200" aria-label="ุงููุชูุฌุฉ">
              <circle cx="100" cy="100" r="${r}" fill="none" stroke-width="16" class="stroke-bg"></circle>
              <circle id="fg"
                      cx="100" cy="100" r="${r}"
                      fill="none" stroke-width="16"
                      class="stroke-fg"
                      transform="rotate(-90 100 100)"
                      stroke-dasharray="${c}"
                      stroke-dashoffset="${c}"></circle>

              <text x="100" y="102" text-anchor="middle" class="score-big">
                <tspan id="pctNum">0</tspan><tspan>%</tspan>
              </text>
              <text x="100" y="128" text-anchor="middle" class="score-small">ุงููุชูุฌุฉ ุงูููุงุฆูุฉ</text>
            </svg>
          </div>

          <div class="result-box">
            <h4>${escapeHtml(msg.title)}</h4>
            <p>${escapeHtml(msg.body)}</p>

            <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap;">
              <button class="btn primary small" id="btnRestart" type="button">ุฅุนุงุฏุฉ</button>
              <button class="btn ghost small" id="btnDone" type="button">ุฅุบูุงู</button>
            </div>
          </div>
        </div>
      `;

      const fg = document.getElementById("fg");
      requestAnimationFrame(() => {
        fg.style.strokeDashoffset = String(c - dash);
      });

      animateNumber("pctNum", 0, pct, 900);

      document.getElementById("btnRestart").addEventListener("click", () => {
        step = 0;
        answers = new Array(active.questions.length).fill(null);
        locked  = new Array(active.questions.length).fill(false);
        renderStep();
      });

      document.getElementById("btnDone").addEventListener("click", closeModal);
    }

    function animateNumber(id, from, to, duration){
      const el = document.getElementById(id);
      const start = performance.now();
      function tick(now){
        const t = Math.min(1, (now - start) / duration);
        const val = Math.round(from + (to - from) * (1 - Math.pow(1 - t, 3)));
        el.textContent = String(val);
        if (t < 1) requestAnimationFrame(tick);
      }
      requestAnimationFrame(tick);
    }

    function escapeHtml(s){
      return String(s)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    btnSurvey.addEventListener("click", () => openModal(survey));
    btnQuiz.addEventListener("click", () => openModal(quiz));

    btnClose.addEventListener("click", closeModal);
    btnCancel.addEventListener("click", closeModal);

    btnPrev.addEventListener("click", () => {
      if (!active) return;
      if (step > 0){ step--; renderStep(); }
    });

    btnNext.addEventListener("click", () => {
      if (!active) return;
      if (answers[step] === null){
        alert("ุงุฎุชุงุฑู ุฅุฌุงุจุฉ ูุจู ูุง ุชููููู ๐");
        return;
      }
      step++;
      renderStep();
    });

    backdrop.addEventListener("click", (e) => {
      if (e.target === backdrop) closeModal();
    });

    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape" && backdrop.classList.contains("open")) closeModal();
    });
  </script>
</body>
</html>
